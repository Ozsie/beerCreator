<div class="containerDiv">
    <table class="beerTable">
        <thead>
            <tr>
                <th>Namn</th>
                <th>Stil</th>
                <th>OG</th>
                <th>FG</th>
                <th>ABV</th>
                <th>IBU</th>
                <th colspan="2">Färg</th>
            </tr>
        </thead>
        <tbody ng-repeat="beer in beerList"
               ng-class-even="'beerTableEven'" ng-class-odd="'beerTableOdd'">
            <tr ng-click="toggle(beer, $index)">
                <td>{{ beer.name }}</td>
                <td>{{ beer.fullStyle.name }}</td>
                <td>{{ getOG(beer) | number : 3 }}</td>
                <td>{{ getFG(beer) | number : 3 }}</td>
                <td>{{ getABV(beer) | number : 1 }} %</td>
                <td>{{ getIBU(beer) | number : 0 }}</td>
                <td>{{ beer.color | number: 1 }} EBC</td>
                <td style="background-color: {{ getColor(beer) }}">
                </td>
            </tr>
            <tr ng-if="openIndex == $index">
                <td colspan="8">
                    <div class="ingredientDiv">
                        <span>Ingredienser</span> <span ng-if="editIndex != $parent.$parent.$index"><button ng-click="addIngredient(beer)">Lägg till</button></span>
                        <div ng-if="showAdd">
                            <div>
                                <select ng-model="newIngredient.type">
                                    <option value="malts">Malt</option>
                                    <option value="hops">Humle</option>
                                    <option value="yeasts">Jäst</option>
                                    <option value="misc">Övrigt</option>
                                </select>
                            </div>
                            <div ng-if="newIngredient.type">
                                <div ng-if="newIngredient.type == 'malts'">
                                    <select ng-model="myColor"
                                            ng-options="malt.name for malt in grainList">
                                    </select>
                                </div>
                            </div>
                        </div>
                        <table class="beerIngredientList">
                            <thead>
                                <tr>
                                    <th>Namn</th>
                                    <th>Mängd</th>
                                    <th>Typ</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody ng-repeat="ingredientType in beer.ingredients">
                                <tr ng-repeat="ingredient in ingredientType">
                                    <td>{{ ingredient.name }}</td>
                                    <td ng-if="editIndex != $parent.$parent.$index">
                                        {{ ingredient.amount }} {{ ingredient.unit }} <span ng-if="ingredient.type == 'malt' || ingredient.type == 'sugar'"> {{ getPercentage(beer, ingredient) | number: 2 }} %</span>
                                    </td>
                                    <td ng-if="editIndex == $parent.$parent.$index">
                                        <input ng-model="ingredient.amount" class="editIngredient"> {{ ingredient.unit }}
                                    </td>
                                    <td>{{ ingredient.type | ingredientType }}</td>
                                    <td>
                                        <button ng-if="editIndex == $parent.$parent.$index" ng-click="deleteIngredient(beer, ingredient, ingredientType, $index)">-</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="otherDiv">
                        <button ng-click="edit(beer, $index)" ng-if="editIndex != $index">Redigera</button>
                        <button ng-click="edit(beer, $index)" ng-if="editIndex == $index">Lås</button>
                        <button ng-click="save(beer, $index)" ng-if="editIndex == $index">Spara</button>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
